<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå - ‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</title>
    <link rel="stylesheet" href="assets/css/style.css">
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar">
        <div class="container">
            <a href="dashboard.html" class="navbar-brand">üîß ‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</a>
            <div class="navbar-menu">
                <a href="dashboard.html">‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>
                <a href="repair-requests.html">‡∏Ñ‡∏≥‡∏£‡πâ‡∏≠‡∏á‡∏ã‡πà‡∏≠‡∏°</a>
                <a href="equipment.html">‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</a>
                <a href="profile.html">‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå</a>
                <span id="userName" style="color: #64748b;"></span>
                <button id="logoutBtn" class="btn-logout">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container">
        <div class="card">
            <div class="card-header">
                <div class="d-flex justify-between align-center">
                    <h2>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</h2>
                    <button id="addEquipmentBtn" class="btn btn-primary">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</button>
                </div>
            </div>

            <!-- Filters -->
            <div class="d-flex gap-2 mb-3" style="flex-wrap: wrap;">
                <input type="text" id="searchInput" class="form-control" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤..." style="max-width: 300px;">
                
                <select id="categoryFilter" class="form-control" style="max-width: 200px;">
                    <option value="">‡∏ó‡∏∏‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</option>
                </select>

                <select id="statusFilter" class="form-control" style="max-width: 200px;">
                    <option value="">‡∏ó‡∏∏‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</option>
                    <option value="true">‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡∏π‡πà</option>
                    <option value="false">‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</option>
                </select>

                <button id="filterBtn" class="btn btn-secondary">üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>
                <button id="resetBtn" class="btn btn-secondary">üîÑ ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï</button>
            </div>

            <!-- Loading -->
            <div id="loading" class="loading">
                <div class="spinner"></div>
                <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>
            </div>

            <!-- Equipment Grid -->
            <div id="equipmentContainer"></div>
        </div>
    </div>

    <!-- Add/Edit Equipment Modal -->
    <div id="equipmentModal" class="modal">
        <div class="modal-content">
            <span class="modal-close" id="closeModal">&times;</span>
            <div class="modal-header" id="modalTitle">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</div>
            
            <form id="equipmentForm">
                <input type="hidden" id="equipmentId">
                
                <div class="form-group">
                    <label for="equipmentCode" class="form-label">‡∏£‡∏´‡∏±‡∏™‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå *</label>
                    <input type="text" id="equipmentCode" class="form-control" required>
                </div>

                <div class="form-group">
                    <label for="name" class="form-label">‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå *</label>
                    <input type="text" id="name" class="form-control" required>
                </div>

                <div class="form-group">
                    <label for="category" class="form-label">‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà *</label>
                    <select id="category" class="form-control" required>
                        <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà --</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="description" class="form-label">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</label>
                    <textarea id="description" class="form-control" rows="3"></textarea>
                </div>

                <div class="form-group">
                    <label for="location" class="form-label">‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á *</label>
                    <input type="text" id="location" class="form-control" required>
                </div>

                <div class="form-group">
                    <label for="purchaseDate" class="form-label">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏î‡∏ã‡∏∑‡πâ‡∏≠</label>
                    <input type="date" id="purchaseDate" class="form-control">
                </div>

                <div class="form-group">
                    <label for="warrantyExpiry" class="form-label">‡∏ß‡∏±‡∏ô‡∏´‡∏°‡∏î‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô</label>
                    <input type="date" id="warrantyExpiry" class="form-control">
                </div>

                <div class="form-group">
                    <label for="condition" class="form-label">‡∏™‡∏†‡∏≤‡∏û *</label>
                    <select id="condition" class="form-control" required>
                        <option value="excellent">‡∏î‡∏µ‡∏°‡∏≤‡∏Å</option>
                        <option value="good" selected>‡∏î‡∏µ</option>
                        <option value="fair">‡∏û‡∏≠‡πÉ‡∏ä‡πâ</option>
                        <option value="poor">‡πÅ‡∏¢‡πà</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="image" class="form-label">‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û</label>
                    <input type="file" id="image" class="form-control" accept="image/*">
                    <small style="color: #64748b;">‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 2MB</small>
                </div>

                <div class="form-group">
                    <label style="display: flex; align-items: center; gap: 0.5rem;">
                        <input type="checkbox" id="isActive" checked>
                        <span>‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡∏π‡πà</span>
                    </label>
                </div>

                <div class="d-flex gap-2">
                    <button type="submit" class="btn btn-primary">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
                    <button type="button" class="btn btn-secondary" id="cancelBtn">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Detail Modal -->
    <div id="detailModal" class="modal">
        <div class="modal-content">
            <span class="modal-close" id="closeDetailModal">&times;</span>
            <div class="modal-header">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</div>
            <div id="detailContent"></div>
        </div>
    </div>

    <script src="assets/js/api.js"></script>
    <script src="assets/js/auth.js"></script>
    <script>
        // Check authentication
        requireAuth();

        let currentEquipment = [];
        let userProfile = null;
        let isEditMode = false;

        // Load user profile
        async function loadProfile() {
            try {
                const profileStr = localStorage.getItem('profile');
                if (profileStr) {
                    userProfile = JSON.parse(profileStr);
                } else {
                    userProfile = await authAPI.getProfile();
                }
            } catch (error) {
                console.error('Error loading profile:', error);
            }
        }

        // Load categories
        async function loadCategories() {
            try {
                const response = await categoryAPI.getAll();
                const categories = response.results || response;
                
                const categorySelect = document.getElementById('category');
                const categoryFilter = document.getElementById('categoryFilter');
                
                categories.forEach(cat => {
                    const option1 = document.createElement('option');
                    option1.value = cat.id;
                    option1.textContent = cat.name;
                    categorySelect.appendChild(option1);
                    
                    const option2 = document.createElement('option');
                    option2.value = cat.id;
                    option2.textContent = cat.name;
                    categoryFilter.appendChild(option2);
                });
            } catch (error) {
                console.error('Error loading categories:', error);
            }
        }

        // Load equipment
        async function loadEquipment(filters = {}) {
            try {
                const loading = document.getElementById('loading');
                loading.classList.add('active');

                const response = await equipmentAPI.getAll(filters);
                currentEquipment = response.results || response;

                displayEquipment(currentEquipment);
                loading.classList.remove('active');
            } catch (error) {
                console.error('Error loading equipment:', error);
                showError('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ');
                document.getElementById('loading').classList.remove('active');
            }
        }

        function displayEquipment(equipment) {
            const container = document.getElementById('equipmentContainer');

            if (equipment.length === 0) {
                container.innerHTML = '<p class="text-center" style="padding: 2rem;">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</p>';
                return;
            }

            const grid = `
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 1.5rem;">
                    ${equipment.map(eq => `
                        <div class="card" style="margin: 0;">
                            ${eq.image ? `<img src="http://127.0.0.1:8000${eq.image}" alt="${eq.name}" style="width: 100%; height: 200px; object-fit: cover; border-radius: 8px 8px 0 0;">` : ''}
                            <div style="padding: 1rem;">
                                <h3 style="margin: 0 0 0.5rem 0; font-size: 1.125rem;">${eq.name}</h3>
                                <p style="color: #64748b; margin: 0 0 0.5rem 0;"><strong>${eq.equipment_code}</strong></p>
                                <p style="margin: 0 0 0.5rem 0;"><strong>‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà:</strong> ${eq.category_name || '-'}</p>
                                <p style="margin: 0 0 0.5rem 0;"><strong>‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà:</strong> ${eq.location}</p>
                                <p style="margin: 0 0 0.5rem 0;"><strong>‡∏™‡∏†‡∏≤‡∏û:</strong> ${eq.condition_display}</p>
                                <p style="margin: 0 0 1rem 0;">
                                    <span class="badge ${eq.is_active ? 'badge-completed' : 'badge-cancelled'}">
                                        ${eq.is_active ? '‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡∏π‡πà' : '‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô'}
                                    </span>
                                </p>
                                <div class="d-flex gap-1" style="flex-wrap: wrap;">
                                    <button class="btn btn-sm btn-primary" onclick="viewDetail(${eq.id})">‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</button>
                                    ${canEdit() ? `<button class="btn btn-sm btn-warning" onclick="editEquipment(${eq.id})">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>` : ''}
                                    ${canDelete() ? `<button class="btn btn-sm btn-danger" onclick="deleteEquipment(${eq.id})">‡∏•‡∏ö</button>` : ''}
                                </div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;

            container.innerHTML = grid;
        }

        function canEdit() {
            return userProfile && (userProfile.role === 'admin' || userProfile.role === 'technician');
        }

        function canDelete() {
            return userProfile && userProfile.role === 'admin';
        }

        async function viewDetail(id) {
            try {
                const equipment = await equipmentAPI.getOne(id);
                
                const content = `
                    <div style="line-height: 1.8;">
                        ${equipment.image ? `<img src="http://127.0.0.1:8000${equipment.image}" alt="${equipment.name}" style="width: 100%; max-height: 300px; object-fit: cover; border-radius: 8px; margin-bottom: 1rem;">` : ''}
                        <p><strong>‡∏£‡∏´‡∏±‡∏™‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå:</strong> ${equipment.equipment_code}</p>
                        <p><strong>‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå:</strong> ${equipment.name}</p>
                        <p><strong>‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà:</strong> ${equipment.category_name || '-'}</p>
                        <p><strong>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î:</strong> ${equipment.description || '-'}</p>
                        <p><strong>‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á:</strong> ${equipment.location}</p>
                        <p><strong>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏î‡∏ã‡∏∑‡πâ‡∏≠:</strong> ${equipment.purchase_date ? new Date(equipment.purchase_date).toLocaleDateString('th-TH') : '-'}</p>
                        <p><strong>‡∏ß‡∏±‡∏ô‡∏´‡∏°‡∏î‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô:</strong> ${equipment.warranty_expiry ? new Date(equipment.warranty_expiry).toLocaleDateString('th-TH') : '-'}</p>
                        <p><strong>‡∏™‡∏†‡∏≤‡∏û:</strong> ${equipment.condition_display}</p>
                        <p><strong>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</strong> <span class="badge ${equipment.is_active ? 'badge-completed' : 'badge-cancelled'}">${equipment.is_active ? '‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡∏π‡πà' : '‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô'}</span></p>
                        <p><strong>‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠:</strong> ${formatDate(equipment.created_at)}</p>
                        <p><strong>‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î:</strong> ${formatDate(equipment.updated_at)}</p>
                    </div>
                `;
                
                document.getElementById('detailContent').innerHTML = content;
                document.getElementById('detailModal').classList.add('active');
            } catch (error) {
                console.error('Error loading detail:', error);
                showError('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÑ‡∏î‡πâ');
            }
        }

        async function editEquipment(id) {
            try {
                const equipment = await equipmentAPI.getOne(id);
                
                isEditMode = true;
                document.getElementById('modalTitle').textContent = '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå';
                document.getElementById('equipmentId').value = equipment.id;
                document.getElementById('equipmentCode').value = equipment.equipment_code;
                document.getElementById('name').value = equipment.name;
                document.getElementById('category').value = equipment.category || '';
                document.getElementById('description').value = equipment.description || '';
                document.getElementById('location').value = equipment.location;
                document.getElementById('purchaseDate').value = equipment.purchase_date || '';
                document.getElementById('warrantyExpiry').value = equipment.warranty_expiry || '';
                document.getElementById('condition').value = equipment.condition;
                document.getElementById('isActive').checked = equipment.is_active;
                
                document.getElementById('equipmentModal').classList.add('active');
            } catch (error) {
                console.error('Error loading equipment:', error);
                showError('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ');
            }
        }

        async function deleteEquipment(id) {
            if (!confirm('‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡∏ö‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ô‡∏µ‡πâ?')) {
                return;
            }

            try {
                await equipmentAPI.delete(id);
                showSuccess('‡∏•‡∏ö‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                loadEquipment();
            } catch (error) {
                console.error('Error deleting equipment:', error);
                showError('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏•‡∏ö‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÑ‡∏î‡πâ');
            }
        }

        // Handle add button
        document.getElementById('addEquipmentBtn').addEventListener('click', () => {
            if (!canEdit()) {
                showError('‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå');
                return;
            }
            
            isEditMode = false;
            document.getElementById('modalTitle').textContent = '‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå';
            document.getElementById('equipmentForm').reset();
            document.getElementById('equipmentId').value = '';
            document.getElementById('equipmentModal').classList.add('active');
        });

        // Handle form submission
        document.getElementById('equipmentForm').addEventListener('submit', async (e) => {
            e.preventDefault();

            const formData = new FormData();
            formData.append('equipment_code', document.getElementById('equipmentCode').value);
            formData.append('name', document.getElementById('name').value);
            formData.append('category', document.getElementById('category').value);
            formData.append('description', document.getElementById('description').value);
            formData.append('location', document.getElementById('location').value);
            
            const purchaseDate = document.getElementById('purchaseDate').value;
            if (purchaseDate) formData.append('purchase_date', purchaseDate);
            
            const warrantyExpiry = document.getElementById('warrantyExpiry').value;
            if (warrantyExpiry) formData.append('warranty_expiry', warrantyExpiry);
            
            formData.append('condition', document.getElementById('condition').value);
            formData.append('is_active', document.getElementById('isActive').checked);

            const imageFile = document.getElementById('image').files[0];
            if (imageFile) {
                formData.append('image', imageFile);
            }

            try {
                if (isEditMode) {
                    const id = document.getElementById('equipmentId').value;
                    await equipmentAPI.update(id, formData);
                    showSuccess('‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                } else {
                    await equipmentAPI.create(formData);
                    showSuccess('‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                }

                document.getElementById('equipmentModal').classList.remove('active');
                document.getElementById('equipmentForm').reset();
                loadEquipment();
            } catch (error) {
                console.error('Error saving equipment:', error);
                showError('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÑ‡∏î‡πâ');
            }
        });

        // Handle filter
        document.getElementById('filterBtn').addEventListener('click', () => {
            const filters = {
                search: document.getElementById('searchInput').value,
                category: document.getElementById('categoryFilter').value,
                is_active: document.getElementById('statusFilter').value
            };
            loadEquipment(filters);
        });

        document.getElementById('resetBtn').addEventListener('click', () => {
            document.getElementById('searchInput').value = '';
            document.getElementById('categoryFilter').value = '';
            document.getElementById('statusFilter').value = '';
            loadEquipment();
        });

        // Modal handlers
        document.getElementById('closeModal').addEventListener('click', () => {
            document.getElementById('equipmentModal').classList.remove('active');
        });

        document.getElementById('cancelBtn').addEventListener('click', () => {
            document.getElementById('equipmentModal').classList.remove('active');
        });

        document.getElementById('closeDetailModal').addEventListener('click', () => {
            document.getElementById('detailModal').classList.remove('active');
        });

        window.addEventListener('click', (e) => {
            if (e.target.classList.contains('modal')) {
                e.target.classList.remove('active');
            }
        });

        // Load data on page load
        document.addEventListener('DOMContentLoaded', () => {
            loadProfile();
            loadCategories();
            loadEquipment();
        });
    </script>
</body>
</html>